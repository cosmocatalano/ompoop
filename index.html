<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
	<title>How many days until Omloop?</title>
	<meta name="description" content="Omloop 2025 will be on a Saturday end of February.">
	<meta name="author" content="huphtur">
	<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸš´</text></svg>">
	<style>
		@media (prefers-color-scheme: dark) {
			html {
				filter: invert(1);
			}
		}

		body {
			color: #000;
			margin-top: 20vh;
			text-align: center;
			background-color: #fff;
			text-transform: uppercase;
			font: 2em/1 'Impact', sans-serif;
		}

		b {
			display: block;
			font-size: 6em;
		}
		small {
			font-size: .8rem;
		}
	</style>
</head>

<body>
	<p>
		<b id="x">How many</b> 
		<!-- <small>or</small>
		<b id="y">How many</b>  -->
		Days until <a href="https://www.omloophetnieuwsblad.be/en">Omloop</a>
	</p>
	<p><small>(this assumes it's the last Satuday in February)</small></p>
	<script>

		//returns the last Saturday in feb 
		function lastSatInFeb(year) {
			//gets the last day in Feb for a given year
			//NB: the 2 in the Date() value here actually indicates March, because months start counting at 0
			//HOWEVER days of the month start counting at 1, so 0 is acually the last day of the previous month (which is Feb) ðŸ™„
			let lastDay = new Date(year, 2, 0);

			//assining an output variable to make the linter happy
			let lastSat;

			//get the day-of-week number for the date value 
			let dayOffset = lastDay.getDay();

			//if the lastday is a Saturday we're good
			if (dayOffset === 6) {
				lastSat = lastDay;
			} else {
				//use the day-of-the-week value to offest back from the end of the month
				//adding one to account for days-of-week counting 0-6(Sun-Sat)
				lastSat = new Date(year, 2, -(dayOffset + 1));

			}

			//return the Date object
			return lastSat;
		}

		//checks what year to use to return the 
		function getNextOmloop() {
			// Get the current date
			const rightNow = new Date();

			//assume next calednar year because that is more likely
			let nextYear = 1;

			//get this year's last Saturday in Feb
			let currentYearLastFebSat = lastSatInFeb(rightNow.getYear);

			// check for Feb 
			if (rightNow.getMonth() === 1) {
				//get the last Saturday in Feb for the current year
				if (rightNow.getDate() < currentYearLastFebSat.getDate()) {
					let nextYear = 0;
				} 
			} else {
				//already passe the Feb test, so if it's not Jan, we use next year this year
				if (rightNow.getMonth() === 0) {
					let nextYear = 0;
				} 
			}
			// if we're a next-calendar-year Omloop, add 1
			nextOmloop = lastSatInFeb(currentYearLastFebSat + nextYear);
			
			//return date
			return nextOmloop;
		}

		let x = document.getElementById("x");
		let y = document.getElementById("y");
		let a = Math.ceil(Math.abs(new Date() - new Date('2025-02-21')) / 86400000);
		x.innerHTML = `${a}`;
		// document.title = `${a} Days until Omloop`;
	</script>
</body>

</html>